(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{nI9I:function(e,n,r){"use strict";r.r(n),r.d(n,"_frontmatter",(function(){return b})),r.d(n,"default",(function(){return l}));var t=r("shca"),c=(r("xwgP"),r("N0F1")),a=r("Hv6d"),p=r("JLKy"),b={},s={_frontmatter:b},o=a.default;function l(e){var n=e.components,r=Object(t.a)(e,["components"]);return Object(c.b)(o,Object.assign({},s,r,{components:n,mdxType:"MDXLayout"}),Object(c.b)("h3",null,"代理转发"),Object(c.b)(p.a,{mdxType:"P"},"访问3000端口，会被转发到5000端口，页面显示port 5000"),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"服务a")),Object(c.b)(p.a,{style:{background:"#FDB99B"},mdxType:"P"},Object(c.b)("pre",null,Object(c.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"const app = require('http')\nconst httpProxy = require('http-proxy')\nconst proxy=httpProxy.createProxyServer()\napp.createServer((req, res) => {\n    proxy.web(req,res,{\n        target:'http://localhost:5000'\n    })\n}).listen(3000, () => {\n    console.log('run server 3000 ')\n})\n"))),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"服务b")),Object(c.b)(p.a,{style:{background:"#FDB99B"},mdxType:"P"},Object(c.b)("p",null,"const app = require('http')",Object(c.b)("br",null),"\napp.createServer((req, res) => {",Object(c.b)("br",null),"\nres.end('port 5000')",Object(c.b)("br",null),"\n}).listen(5000, () => {",Object(c.b)("br",null),"\nconsole.log('run server')",Object(c.b)("br",null),"\n})")),Object(c.b)("h3",null,"模拟nginx反向代理"),Object(c.b)(p.a,{mdxType:"P"},"监听同一个端口，根据上下文，分发到不同的服务上。",Object(c.b)("br",null),"代理机和两台服务分别跑在8080，3000，3001端口。",Object(c.b)("br",null),"访问:http://localhost:8080/server/1 页面显示==>server1",Object(c.b)("br",null),"访问:http://localhost:8080/server/2 页面显示==>server2",Object(c.b)("br",null)),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"代理机proxy")),Object(c.b)("pre",null,Object(c.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"const app = require('http')\nconst httpProxy = require('http-proxy')\nconst url = require('url')\nconst proxy = httpProxy.createProxyServer()\n//代理路径映射 相当于nginx的 proxy_pass\nconst map = {\n    '/server/1': 'http://localhost:3000',\n    '/server/2': 'http://localhost:3001',\n}\napp.createServer((req, res) => {\n    const {pathname} =url.parse(req.url)\n    if (pathname === '/favicon.ico') return res.end()\n    proxy.web(req, res, {\n        target: map[pathname]\n    })\n}).listen(8080, () => {\n    console.log('run server 8080 ')\n})\n")),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"服务机1")),Object(c.b)("pre",null,Object(c.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"const app = require('http')\napp.createServer((req, res) => {\n    res.end('server1')\n}).listen(3000)\n")),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"服务机2")),Object(c.b)("pre",null,Object(c.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"\nconst app = require('http')\napp.createServer((req, res) => {\n    res.end('server2')\n}).listen(3001)\n")))}l.isMDXComponent=!0},shca:function(e,n,r){"use strict";function t(e,n){if(null==e)return{};var r,t,c={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(c[r]=e[r]);return c}r.d(n,"a",(function(){return t}))}}]);
//# sourceMappingURL=component---src-pages-node-http-proxy-index-mdx-91f967ecd0304f6756aa.js.map