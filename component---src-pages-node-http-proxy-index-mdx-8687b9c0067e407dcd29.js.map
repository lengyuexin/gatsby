{"version":3,"sources":["webpack:///./src/pages/node/http-proxy/index.mdx"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","style","background","isMDXComponent"],"mappings":"4RAOO,IAAMA,EAAe,GAOtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,E,oIACF,mBACD,OAAO,YAACJ,EAAD,iBAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAI5E,8BACA,YAAC,IAAD,CAAGA,QAAQ,KAAX,sCAGA,qBAAG,sBAAQC,WAAW,KAAnB,QACH,YAAC,IAAD,CAAGC,MAAO,CACRC,WAAY,WACXH,QAAQ,KACT,uBAAK,kCAAMC,WAAW,OAAU,CAC5B,UAAa,gBADZ,oSAcP,qBAAG,sBAAQA,WAAW,KAAnB,QACH,YAAC,IAAD,CAAGC,MAAO,CACRC,WAAY,WACXH,QAAQ,KACT,mDAAkC,uBAAlC,qCAC4B,uBAD5B,yBAEgB,uBAFhB,4BAGmB,uBAHnB,8BAIqB,uBAJrB,SAOF,qCACA,YAAC,IAAD,CAAGA,QAAQ,KAAX,2BACoB,uBADpB,gCAEyB,uBAFzB,mDAG4C,uBAH5C,mDAI4C,wBAE5C,qBAAG,sBAAQC,WAAW,KAAnB,aACH,uBAAK,kCAAMA,WAAW,OAAU,CAC5B,UAAa,gBADZ,kiBAqBL,qBAAG,sBAAQA,WAAW,KAAnB,SACH,uBAAK,kCAAMA,WAAW,OAAU,CAC5B,UAAa,gBADZ,6GAOL,qBAAG,sBAAQA,WAAW,KAAnB,SACH,uBAAK,kCAAMA,WAAW,OAAU,CAC5B,UAAa,gBADZ,gHAYTJ,EAAWO,gBAAiB","file":"component---src-pages-node-http-proxy-index-mdx-8687b9c0067e407dcd29.js","sourcesContent":["import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/bytedance/Desktop/gatsby/src/components/BlogLayout/index.js\";\nimport P from '../../../components/Panel.js';\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n    <h3>{`代理转发`}</h3>\n    <P mdxType=\"P\"> \n访问3000端口，会被转发到5000端口，页面显示port 5000\n    </P>\n    <p><strong parentName=\"p\">{`服务a`}</strong></p>\n    <P style={{\n      background: '#FDB99B'\n    }} mdxType=\"P\">\n      <pre><code parentName=\"pre\" {...{\n          \"className\": \"language-js\"\n        }}>{`const app = require('http')\nconst httpProxy = require('http-proxy')\nconst proxy=httpProxy.createProxyServer()\napp.createServer((req, res) => {\n    proxy.web(req,res,{\n        target:'http://localhost:5000'\n    })\n}).listen(3000, () => {\n    console.log('run server 3000 ')\n})\n`}</code></pre>\n    </P>\n    <p><strong parentName=\"p\">{`服务b`}</strong></p>\n    <P style={{\n      background: '#FDB99B'\n    }} mdxType=\"P\">\n      <p>{`const app = require('http')`}<br />{`\napp.createServer((req, res) => {`}<br />{`\nres.end('port 5000')`}<br />{`\n}).listen(5000, () => {`}<br />{`\nconsole.log('run server')`}<br />{`\n})`}</p>\n    </P>\n    <h3>{`模拟nginx反向代理`}</h3>\n    <P mdxType=\"P\"> \n监听同一个端口，根据上下文，分发到不同的服务上。<br />\n代理机和两台服务分别跑在8080，3000，3001端口。<br />\n访问:http://localhost:8080/server/1 页面显示==>server1<br />\n访问:http://localhost:8080/server/2 页面显示==>server2<br />\n    </P>\n    <p><strong parentName=\"p\">{`代理机proxy`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const app = require('http')\nconst httpProxy = require('http-proxy')\nconst url = require('url')\nconst proxy = httpProxy.createProxyServer()\n//代理路径映射 相当于nginx的 proxy_pass\nconst map = {\n    '/server/1': 'http://localhost:3000',\n    '/server/2': 'http://localhost:3001',\n}\napp.createServer((req, res) => {\n    const {pathname} =url.parse(req.url)\n    if (pathname === '/favicon.ico') return res.end()\n    proxy.web(req, res, {\n        target: map[pathname]\n    })\n}).listen(8080, () => {\n    console.log('run server 8080 ')\n})\n`}</code></pre>\n    <p><strong parentName=\"p\">{`服务机1`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const app = require('http')\napp.createServer((req, res) => {\n    res.end('server1')\n}).listen(3000)\n`}</code></pre>\n    <p><strong parentName=\"p\">{`服务机2`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`\nconst app = require('http')\napp.createServer((req, res) => {\n    res.end('server2')\n}).listen(3001)\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}