(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{BiVN:function(e,n,t){},EsZP:function(e,n,t){},Hv6d:function(e,n,t){"use strict";var r=t("KPh1"),a=t("qRUh"),s=t("xwgP"),l=t.n(s),c=t("Wbzz"),o=t("d33t"),i=t.n(o),u=(t("vPK/"),t("Zttt")),b=t("EYWl"),p=t("JLKy"),m=t("k7Sn"),f=function(e){return m.supportedLanguages[e].replace(/ /g," ")},j=function(e){function n(){return e.apply(this,arguments)||this}return Object(a.a)(n,e),n.prototype.render=function(){var e=this.props,n=e.translations,t=e.lang,r=e.languageLink,a=e.editUrl;return l.a.createElement("div",{className:"translations"},l.a.createElement(p.a,{style:{fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",\n    "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans",\n    "Droid Sans", "Helvetica Neue", sans-serif'}},n.length>0&&l.a.createElement(l.a.Fragment,null,l.a.createElement("span",null,"Translated by readers into: "),n.map((function(e,a){return l.a.createElement(l.a.Fragment,{key:e},e===t?l.a.createElement("b",null,f(e)):l.a.createElement(c.Link,{to:r(e)},f(e)),a===n.length-1?"":" • ")}))),"zh-hans"!==t&&l.a.createElement(l.a.Fragment,null,l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(c.Link,{to:r("zh-hans")},"Read the original")," • ",l.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},"Improve this translation")," • ",l.a.createElement(c.Link,{to:"/"+t},"View all translated posts")," ")))},n}(l.a.Component),h=t("L6NH"),d=t("p3AD");function g(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function O(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?g(Object(t),!0).forEach((function(n){Object(r.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var v=function(e){function n(){return e.apply(this,arguments)||this}return Object(a.a)(n,e),n.prototype.render=function(){console.log(this.props);var e=this.props,n=e.pageContext,r=e.children,a=e.location,s=e.previous,o=e.next,p=e.translations,m=i()(this.props,"queryData.site.siteMetadata.title"),g=n.langKey,v=n.slug;p&&(p=p.slice()).sort((function(e,n){return f(e)<f(n)?-1:1})),function(e){switch(e){case"ru":case"bg":t("EsZP"),t("s85H");break;case"uk":t("EsZP"),t("s85H"),t("Mq6Z"),t("e/YJ");break;case"cs":case"da":case"de":case"es":case"fi":case"fr":case"he":case"hu":case"it":case"nl":case"no":case"pl":case"pt-br":case"sk":case"sr":case"sq":case"sv":case"tr":t("Mq6Z"),t("e/YJ");break;case"vi":t("Vjog"),t("Pf5Y");break;case"fa":t("BiVN");break;case"ar":t("xpFW")}}(g);var y=function(e,n){var t=e.replace(n+"/","");return function(e){return"zh-hans"===e?t:""+e+t}}(v,g),E=y("en"),P="https://github.com/gaearon/overreacted.io/edit/master/src/pages/"+E.slice(1,E.length-1)+"/index"+("zh-hans"===g?"":"."+g)+".md";return l.a.createElement(u.a,{location:a,title:m},l.a.createElement(b.a,{lang:g,title:n.frontmatter.title,description:n.frontmatter.spoiler,slug:v,date:n.frontmatter.date}),l.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto",maxWidth:Object(d.a)(24)}},l.a.createElement("article",null,l.a.createElement("header",null,l.a.createElement("h1",{style:{color:"var(--textTitle)"}},n.frontmatter.title),l.a.createElement("p",{style:O(O({},Object(d.b)(-.2)),{},{display:"block",marginBottom:Object(d.a)(1),marginTop:Object(d.a)(-.8)})},Object(h.a)(n.frontmatter.date,g)),p&&p.length>0&&l.a.createElement(j,{translations:p,editUrl:P,languageLink:y,lang:g})),l.a.createElement("div",null,r)),l.a.createElement("aside",null,l.a.createElement("nav",null,l.a.createElement("ul",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",listStyle:"none",padding:0}},l.a.createElement("li",null,s&&l.a.createElement(c.Link,{to:s.fields.slug,rel:"prev",style:{marginRight:20}},"← ",s.frontmatter.title)),l.a.createElement("li",null,o&&l.a.createElement(c.Link,{to:o.fields.slug,rel:"next"},o.frontmatter.title," →")))))))},n}(l.a.Component);n.a=function(e){return l.a.createElement(c.StaticQuery,{query:"2199005656",render:function(n){return l.a.createElement(v,Object.assign({queryData:n},e))}})}},LfUm:function(e,n,t){"use strict";t.r(n),t.d(n,"_frontmatter",(function(){return c})),t.d(n,"default",(function(){return u}));var r=t("shca"),a=(t("xwgP"),t("N0F1")),s=t("Hv6d"),l=t("JLKy"),c={},o={_frontmatter:c},i=s.a;function u(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(a.b)(i,Object.assign({},o,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h3",null,"推荐阅读"),Object(a.b)("p",null,Object(a.b)("a",Object.assign({parentName:"p"},{href:"https://juejin.cn/post/6844904116913700877"}),"https://juejin.cn/post/6844904116913700877")),Object(a.b)("h3",null,"Promise(简化版)"),Object(a.b)(l.a,{style:{background:"#FDB99B"},mdxType:"P"},Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"// 先定义三个常量表示状态\nconst PENDING = 'pending';\nconst FULFILLED = 'fulfilled';\nconst REJECTED = 'rejected';\n\nfunction MyPromise(fn) {\n    this.status = PENDING;    // 初始状态为pending\n    this.value = null;        // 初始化value\n    this.reason = null;       // 初始化reason\n\n    // 构造函数里面添加两个数组存储成功和失败的回调\n    this.onFulfilledCallbacks = [];\n    this.onRejectedCallbacks = [];\n\n    // resolve方法参数是value\n    resolve = (value) => {\n        if (this.status === PENDING) {\n            this.status = FULFILLED;\n            this.value = value;\n            // resolve里面将所有成功的回调拿出来执行\n            this.onFulfilledCallbacks.forEach(callback => {\n                callback(this.value);\n            });\n        }\n    }\n\n    // reject方法参数是reason\n    reject = (reason) => {\n        if (this.status === PENDING) {\n            this.status = REJECTED;\n            this.reason = reason;\n            // resolve里面将所有失败的回调拿出来执行\n            this.onRejectedCallbacks.forEach(callback => {\n                callback(this.reason);\n            });\n        }\n    }\n\n    try {\n        fn(resolve, reject);\n    } catch (error) {\n        reject(error);\n    }\n}\n\nMyPromise.prototype.then = function (onFulfilled, onRejected) {\n    if (this.status === FULFILLED) {\n        onFulfilled(this.value)\n    }\n    if (this.status === REJECTED) {\n        onRejected(this.reason);\n    }\n    // 如果还是PENDING状态，将回调保存下来\n    if (this.status === PENDING) {\n        this.onFulfilledCallbacks.push(onFulfilled);\n        this.onRejectedCallbacks.push(onRejected);\n    }\n    return this\n}\n\n\n\n"))),Object(a.b)("h3",null,"Promise.resolve"),Object(a.b)(l.a,{mdxType:"P"},"如果是Promise的实例,就直接返回。如果不是则用Promise包裹一下后返回"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"\nPromise.resolve = function (p) {\n    if (p instanceof Promise)  return p;\n    return new Promise(function (resolve) {\n        resolve(p);\n    });\n}\n\n")),Object(a.b)("h3",null,"Promise.reject"),Object(a.b)(l.a,{mdxType:"P"},"返回一个新的Promise实例，该实例的状态为rejected"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"\nPromise.reject = function (reason) {\n    return new Promise(function (resolve,reject) {\n        reject(reason);\n    });\n}\n\n")),Object(a.b)("h3",null,"Promise.all"),Object(a.b)(l.a,{mdxType:"P"},"接收一个包含promsie的数组",Object(a.b)("br",null),"不是promise的会转为promsie",Object(a.b)("br",null),"必须等待所有的promise成功最后的结果才会resolve",Object(a.b)("br",null),"其最终结果是一个数组,顺序与书写顺序一致",Object(a.b)("br",null),"有一个失败则最终结果失败,返回第一个失败的reject"),Object(a.b)(l.a,{style:{background:"#FDB99B"},mdxType:"P"},Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"\nfunction all(promises=[]){\n    return new Promise((resolve,reject)=>{\n        let res=[]\n        let count=0;\n        let len=promises.length \n        if(len===0) return resolve(res)\n\n        promises.forEach((p,i)=>{\n            Promise.resolve(p).then((value)=>{\n                count++\n                res[i]=value \n                if(count===len){\n                    resolve(res)\n                }\n            },(reason)=>{\n                reject(reason)\n            })\n        })\n    })\n}\n\n"))),Object(a.b)("h3",null,"Promise.race"),Object(a.b)(l.a,{mdxType:"P"},"接收一个包含promsie的数组",Object(a.b)("br",null),"不是promise的会转为promsie",Object(a.b)("br",null),"不必等待所有的promise成功，最先完成的那个直接返回",Object(a.b)("br",null),"一旦成功或失败不能转为其他状态，会立即结束，resolve和reject也会竞速"),Object(a.b)(l.a,{style:{background:"#FDB99B"},mdxType:"P"},Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"\nfunction race(promises = []) {\n    return new Promise((resolve, reject) => {\n        let len = promises.length\n        if (len === 0) return resolve()\n        for (let i = 0; i < len; i++) {\n            const p = promises[i];\n            Promise.resolve(p).then((value) => {\n                return resolve(value)\n            }, (reason) => {\n                return reject(reason)\n            })\n\n        }\n    })\n}\n\n"))),Object(a.b)("h3",null,"catch"),Object(a.b)(l.a,{mdxType:"P"},"Promise中的catch是.then(null, rejection)或.then(undefined, rejection)的别名",Object(a.b)("br",null),"用于指定发生错误时的回调函数"),Object(a.b)(l.a,{style:{background:"#FDB99B"},mdxType:"P"},Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"Promise.prototype.catch = function(onRejected) {\n  this.then(null, onRejected);\n}\n"))))}u.isMDXComponent=!0},Mq6Z:function(e,n,t){},Pf5Y:function(e,n,t){},Vjog:function(e,n,t){},"e/YJ":function(e,n,t){},k7Sn:function(e,n){n.supportedLanguages={en:"English","zh-hans":"简体中文"}},s85H:function(e,n,t){},shca:function(e,n,t){"use strict";function r(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}t.d(n,"a",(function(){return r}))},"vPK/":function(e,n,t){},xpFW:function(e,n,t){}}]);
//# sourceMappingURL=component---src-pages-js-core-promise-index-mdx-6fd71d711d0dedcb25a3.js.map