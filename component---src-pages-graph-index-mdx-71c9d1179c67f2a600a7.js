(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{Rbsh:function(e,t,b){"use strict";b.r(t),b.d(t,"_frontmatter",(function(){return c})),b.d(t,"default",(function(){return r}));b("rGqo"),b("yt8O"),b("Btvt"),b("RW0V"),b("91GP"),b("q1tI");var n=b("7ljp"),l=b("Hv6d");var c={},a={_frontmatter:c},p=l.a;function r(e){var t=e.components,b=function(e,t){if(null==e)return{};var b,n,l={},c=Object.keys(e);for(n=0;n<c.length;n++)b=c[n],t.indexOf(b)>=0||(l[b]=e[b]);return l}(e,["components"]);return Object(n.b)(p,Object.assign({},a,b,{components:t,mdxType:"MDXLayout"}),Object(n.b)("h2",null,"前言"),Object(n.b)("p",null,"在字节内部，有一个自研的图数据库，叫做bytegrpah。"),Object(n.b)("p",null,"刚好近期业务有用到，使用体验还是很棒的。"),Object(n.b)("p",null,"不论是语法理解还是逻辑便捷性，在特定场景下，确实比关系型数据库更有优势。"),Object(n.b)("p",null,"本文以bytegraph为例,介绍下图数据库的概念，落地场景以及基本使用。"),Object(n.b)("p",null,"希望本文对你有所帮助。"),Object(n.b)("h2",null,"图数据库是什么"),Object(n.b)("p",null,"顾名思义，图数据库也是数据库。这就意味着，它具有数据库的一些共性。比如事务，增删改查操作。"),Object(n.b)("p",null,"不同于关系型数据库，它存储的是由点和边以及附加属性构成的逻辑关系。"),Object(n.b)("p",null,"当这些逻辑关系连在一起时，就构成了一张图谱。"),Object(n.b)("p",null,"这，就是图数据库。"),Object(n.b)("h2",null,"核心概念"),Object(n.b)("h3",null,"点"),Object(n.b)("p",null,"一般来说，可以把点对应到关系型数据库中的表，其实就是一个实体(比如用户)。"),Object(n.b)("p",null,"每一张表中存储的数据必然是相同结构，图数据中存储的同类型点也是如此。"),Object(n.b)("h3",null,"边"),Object(n.b)("p",null,"两点之间建立关联指向的连线则为边，包含正向边，反向边和双向边。"),Object(n.b)("p",null,"以关注关系为例:"),Object(n.b)("table",null,Object(n.b)("thead",{parentName:"table"},Object(n.b)("tr",{parentName:"thead"},Object(n.b)("th",Object.assign({parentName:"tr"},{align:null})),Object(n.b)("th",Object.assign({parentName:"tr"},{align:null})),Object(n.b)("th",Object.assign({parentName:"tr"},{align:null})))),Object(n.b)("tbody",{parentName:"table"},Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",Object.assign({parentName:"tr"},{align:null}),"正向边"),Object(n.b)("td",Object.assign({parentName:"tr"},{align:null}),"反向边"),Object(n.b)("td",Object.assign({parentName:"tr"},{align:null}),"双向边")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",Object.assign({parentName:"tr"},{align:null}),"A关注B(A->B)"),Object(n.b)("td",Object.assign({parentName:"tr"},{align:null}),"B被A 关注(B <-A)"),Object(n.b)("td",Object.assign({parentName:"tr"},{align:null}),"A与B互相关注(A<=>B)")))),Object(n.b)("h3",null,"属性"),Object(n.b)("p",null,"图数据库的属性就如同关系型数据库中表的各个字段一样，只不过它附加在了点和边上。"),Object(n.b)("p",null,"下面用一张图介绍下点，边，属性是如何建立关联的。"),Object(n.b)("p",null,Object(n.b)("img",Object.assign({parentName:"p"},{src:"https://img-blog.csdnimg.cn/50f114f7344e4162b0b0cbc407856854.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyODEzNDkx,size_16,color_FFFFFF,t_70",alt:null}))),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"player,team是点"),Object(n.b)("li",{parentName:"ul"},"两点中间的指向为边"),Object(n.b)("li",{parentName:"ul"},"id,name,age为点的属性，serve,start_year,end_year为边的属性")),Object(n.b)("h2",null,"通用概念"),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"n跳查询:沿着指定链路查n次")),Object(n.b)("blockquote",null,Object(n.b)("p",{parentName:"blockquote"},"查询A的关注，是一跳查询。查询A的关注中B的关注，是两跳查询。以此类推...")),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"入边和出边：箭头起为出边，止为入边")),Object(n.b)("blockquote",null,Object(n.b)("p",{parentName:"blockquote"},"对于上图中点player而言，边serve是出边；对于点team而言，边serve是入边。")),Object(n.b)("h2",null,"落地场景"),Object(n.b)("p",null,"一句话，一旦你的业务场景存在图的关系，就有考虑图数据库的必要。"),Object(n.b)("p",null,"比如抖音，微博的粉丝关注关系，这个就是经典的落地场景。"),Object(n.b)("p",null,"人带有明显的社会属性，每个人都可以关注别人，也可以被其他人关注。"),Object(n.b)("p",null,"当这种复杂的关注关系串联起来，其实就是一张图。"),Object(n.b)("p",null,"在前端图谱展现上，可以配合g6使用，定制点边结构即可。\n",Object(n.b)("img",Object.assign({parentName:"p"},{src:"https://img-blog.csdnimg.cn/e77c34c7a9ed4169b055d4728c1c71f3.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyODEzNDkx,size_16,color_FFFFFF,t_70",alt:null}))),Object(n.b)("h2",null,"基本使用"),Object(n.b)("p",null,"在使用上，bytegraph采用germlin查询语言，可以把这个当成sql用。"),Object(n.b)("p",null,"看似是学习一个新的东西，但成本不高，这个理解上比sql直观许多。"),Object(n.b)("p",null,"下面来看几个常用操作吧。"),Object(n.b)("h3",null,"添加一个点"),Object(n.b)("p",null,"在bytegraph中，使用id和type确定一个点，这个是可以自定义的。"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{}),"  g.addV()\n  .property('id',A.id)\n  .property('type',A.type)\n  .property('name',A.name)\n")),Object(n.b)("h3",null,"建立一条边"),Object(n.b)("p",null,"很好理解的form和to，在给定的A,B两点之间建立边的指向。"),Object(n.b)("p",null,"边的名字unit也是可以自定义的，比如follow。"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{}),"g.addE('unit').from(A.id,A.type).to(B.id,B.type)\n")),Object(n.b)("h3",null,"查询某个点的属性"),Object(n.b)("p",null,"类似mysql中的",Object(n.b)("inlineCode",{parentName:"p"},"select name from A")),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{}),'g.V().has("id", A.id).has("type", A.type).properties("name")\n')),Object(n.b)("h3",null,"查询某个点的出边和入边"),Object(n.b)("p",null,"假定该边名为unit。"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{}),"g.V().has('id', A.id).has('type',A.type).bothE('unit')`;\n")),Object(n.b)("h3",null,"清除某个点的出入边"),Object(n.b)("p",null,"一般来说，点不会被删，最多删除点的属性。"),Object(n.b)("p",null,"如果要清除点之间的联系，去掉其出入边即可。"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{}),"g.V().has('id',A.id).has('type',A.type).bothE('unit').drop()\n")),Object(n.b)("h3",null,"A所在关注关系联通子图上的所有人"),Object(n.b)("p",null,"这个应该是最为经典的使用了，查询所有关联，最高跳查询。"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{}),'g.V().has("id", A.id).has("type", A.type)\n .repeat(             // repeat()表示表示迭代从A找关注or被关注的人\n        both("follow")\n        .simplePath()) // simplePath()是过滤条件，出现环则过滤掉\n .emit()    // emit()表示输出每个遍历到的点，\n .times(10)  //times(10)设置一个足够大的循环次数，当循环找不到新的点时，repeat会自动结束\n')),Object(n.b)("h2",null,"更多"),Object(n.b)("p",null,"更多bytegraph介绍：",Object(n.b)("a",Object.assign({parentName:"p"},{href:"https://blog.csdn.net/ByteDanceTech/article/details/104509642/"}),"字节跳动自研万亿级图数据库 & 图计算实践")),Object(n.b)("p",null,"更多gremlin语法介绍: ",Object(n.b)("a",Object.assign({parentName:"p"},{href:"http://tinkerpop-gremlin.cn/"}),"Gremlin中文文档")),Object(n.b)("h2",null,"再会"),Object(n.b)("p",null,"情如风雪无常,"),Object(n.b)("p",null,"却是一动即殇。"),Object(n.b)("p",null,"感谢你这么好看还来阅读我的文章,"),Object(n.b)("p",null,"我是冷月心,下期再见。"))}r.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-graph-index-mdx-71c9d1179c67f2a600a7.js.map